#!/bin/bash
# Real-time test script

echo "ğŸ§ª REAL-TIME AGENT TEST"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "ğŸ“‹ INSTRUCTIONS:"
echo ""
echo "1. Open your browser and join a room (any room)"
echo "2. Keep the room open"
echo "3. This script will watch Fly.io logs for 30 seconds"
echo "4. You'll see if the agent detects you and processes your audio"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
read -p "Press ENTER when you're IN A ROOM and ready to test..."
echo ""
echo "ğŸ” Watching Fly.io logs for 30 seconds..."
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

timeout 30 flyctl logs --app rv2class-audio-agent 2>&1 | grep -E "(Connected|Found.*participants|ğŸ‘‹|ğŸ“¢|ğŸ“¡|ğŸ¤|ğŸ™ï¸|ğŸ”Š|Error)" --line-buffered

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… Test complete!"
echo ""
echo "ğŸ” WHAT TO LOOK FOR:"
echo ""
echo "âœ… WORKING:"
echo "   ğŸ“¢ Track published - Kind: 1, Participant: YOUR_NAME"
echo "   ğŸ“¡ Subscribing to audio track from: YOUR_NAME"
echo "   ğŸ¤ Subscribed to audio from: YOUR_NAME"
echo "   ğŸ™ï¸ Publishing DeepFiltered track: YOUR_NAME_deepfiltered"
echo "   ğŸ”Š YOUR_NAME audio level: XX.X"
echo ""
echo "âŒ NOT WORKING:"
echo "   ğŸ“Š Found 0 existing participants"
echo "   (No other messages)"
echo ""
